graph TB
    subgraph "3WM AI Document Intelligence Pipeline"
        A[Invoice Input] --> B[OCR Processing Layer]
        B --> C[AI Extraction & Validation]
        C --> D[Knowledge Base Integration]
        D --> E[ML Model Training & Prediction]
        E --> F[Action Logging & Feedback Loop]
        F --> G[End-to-End Validation]
        
        B --> B1[ðŸ“„ Document Preprocessing]
        B --> B2[ðŸ” OCR Engine (DocTR/TrOCR)]
        B --> B3[ðŸ“ Text Extraction & Cleanup]
        B --> B4[ðŸ¤– OCR Quality Assessment AI]
        
        C --> C1[ðŸ¤– GPT-4o Field Extraction]
        C --> C2[ðŸ”¢ European Number Parsing AI]
        C --> C3[âœ… Business Rule Validation]
        C --> C4[ðŸ¤– Fraud Detection AI Agent]
        C --> C5[ðŸ” Duplicate Detection AI]
        
        D --> D1[ðŸ“š Vector Embeddings Storage]
        D --> D2[ðŸ§  Knowledge Base Query]
        D --> D3[ðŸ”— Semantic Similarity Search]
        D --> D4[ðŸ¤– Context-Aware Prediction AI]
        D --> D5[ðŸ“Š Historical Pattern Analysis]
        
        E --> E1[ðŸŽ¯ Journal Entry Prediction]
        E --> E2[ðŸ“ˆ Confidence Score Calculation]
        E --> E3[ðŸ”„ Model Retraining Pipeline]
        E --> E4[ðŸ¤– Adaptive Learning AI]
        E --> E5[ðŸ“Š Performance Metrics Tracking]
        
        F --> F1[ðŸ“ Action Logging System]
        F --> F2[ðŸ”„ User Correction Capture]
        F --> F3[ðŸ“Š Training Data Generation]
        F --> F4[ðŸ¤– Feedback Processing AI]
        F --> F5[ðŸŽ¯ Model Improvement Tracking]
        
        G --> G1[ðŸ§ª End-to-End Test Suite]
        G --> G2[ðŸ“Š Pipeline Performance Metrics]
        G --> G3[ðŸŽ¯ Accuracy Validation]
        G --> G4[ðŸ¤– Confidence Calibration AI]
        G --> G5[ðŸ”„ Continuous Integration Tests]
        
        subgraph "Knowledge Base & Embeddings"
            KB1[ðŸ“š Invoice Templates DB]
            KB2[ðŸ¢ Vendor Knowledge Base]
            KB3[ðŸ“Š Historical Patterns]
            KB4[ðŸ” Embedding Vectors]
        end
        
        subgraph "ML Training Pipeline"
            ML1[ðŸ“Š Training Data Collection]
            ML2[ðŸŽ¯ Feature Engineering]
            ML3[ðŸ¤– Model Training]
            ML4[âœ… Model Validation]
            ML5[ðŸš€ Model Deployment]
        end
        
        D1 --> KB4
        D2 --> KB1
        D2 --> KB2
        D5 --> KB3
        
        F3 --> ML1
        E3 --> ML2
        E4 --> ML3
        G3 --> ML4
        E1 --> ML5
    end
    
    style A fill:#fff3e0,stroke:#333,stroke-width:2px,color:#000
    style G fill:#e8f5e9,stroke:#333,stroke-width:2px,color:#000
    style F1 fill:#e3f2fd,stroke:#333,stroke-width:2px,color:#000
    style F2 fill:#e3f2fd,stroke:#333,stroke-width:2px,color:#000
    style B4 fill:#f3e5f5,stroke:#333,stroke-width:1px,color:#000
    style C1 fill:#f3e5f5,stroke:#333,stroke-width:1px,color:#000
    style C2 fill:#f3e5f5,stroke:#333,stroke-width:1px,color:#000
    style C4 fill:#f3e5f5,stroke:#333,stroke-width:1px,color:#000
    style C5 fill:#f3e5f5,stroke:#333,stroke-width:1px,color:#000
    style D2 fill:#f3e5f5,stroke:#333,stroke-width:1px,color:#000
    style D4 fill:#f3e5f5,stroke:#333,stroke-width:1px,color:#000
    style D5 fill:#f3e5f5,stroke:#333,stroke-width:1px,color:#000
    style E2 fill:#f3e5f5,stroke:#333,stroke-width:1px,color:#000
    style E4 fill:#f3e5f5,stroke:#333,stroke-width:1px,color:#000
    style F3 fill:#f3e5f5,stroke:#333,stroke-width:1px,color:#000
    style F4 fill:#f3e5f5,stroke:#333,stroke-width:1px,color:#000
    style G4 fill:#f3e5f5,stroke:#333,stroke-width:1px,color:#000
    style G5 fill:#f3e5f5,stroke:#333,stroke-width:1px,color:#000